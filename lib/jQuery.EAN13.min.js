/* 
* Copyright (c) 2012 Johannes Mittendorfer (http://jmittendorfer.hostingsociety.com)
* Licensed under the MIT License (LICENSE.txt).
*
* Version: 1.1
*/
var l=jQuery;
l.fn.EAN13=function(h,n){var j=l.extend({a:!0,prefix:!0,e:function(){},d:function(){},c:function(){},color:"#000"},n),f=this[0];return this.each(function(){l.each(h.split(""),function(){});var a="0001101 0011001 0010011 0111101 0100011 0110001 0101111 0111011 0110111 0001011".split(" "),n="0100111 0110011 0011011 0100001 0011101 0111001 0000101 0010001 0001001 0010111".split(" "),r="1110010 1100110 1101100 1000010 1011100 1001110 1010000 1000100 1001000 1110100".split(" "),p=j.prefix?0.8*f.width:f.width;
if(j.a)var e=0.9*f.height,m=0.9*e;else e=1*f.height,m=0.9*e;var b=p/95,g="",s="xxxxxx xxyxyy xxyyxy xxyyyx xyxxyy xyyxxy xyyyxx xyxyxy xyxyyx xyyxyx".split(" ")[parseInt(h.substr(0,1))].split(""),t=h.substr(0,1);h=h.substr(1);for(var q=h.split(""),c=0;6>c;c++)g="x"==s[c]?g+a[q[c]]:g+n[q[c]];for(c=6;12>c;c++)g+=r[q[c]];if(f.getContext){var d=f.getContext("2d");d.fillStyle=j.color;a=j.prefix?0.07*f.width:0;g=g.split("");d.fillRect(a,0,b,e);a+=2*b;d.fillRect(a,0,b,e);a+=b;for(c=0;42>c;c++)"1"==g[c]&&
d.fillRect(a,0,b,m),a+=b;a+=b;d.fillRect(a,0,b,e);a+=2*b;d.fillRect(a,0,b,e);a+=2*b;for(c=42;84>c;c++)"1"==g[c]&&d.fillRect(a,0,b,m),a+=b;d.fillRect(a,0,b,e);d.fillRect(a+2*b,0,b,e);if(j.a){d.font=0.2*m+"px monospace";j.prefix&&d.fillText(t,0,1.03*e);var k=3*b+(j.prefix?0.07*f.width:0);l.each(h.substr(0,6).split(""),function(a,b){d.fillText(b,k,1.03*e);k+=0.078*p});k=49*b+(j.prefix?0.07*f.width:0);l.each(h.substr(6).split(""),function(a,b){d.fillText(b,k,1.03*e);k+=0.078*p})}}})};
