/* 
* Copyright (c) 2012 Johannes Mittendorfer (http://jmittendorfer.hostingsociety.com)
* Licensed under the MIT License (LICENSE.txt).
*
* Version: 0.2
*/
(function(j){j.fn.EAN13=function(h,p){var n=j.extend({print_number:!0},p),a="0001101 0011001 0010011 0111101 0100011 0110001 0101111 0111011 0110111 0001011".split(" "),q="0100111 0110011 0011011 0100001 0011101 0111001 0000101 0010001 0001001 0010111".split(" "),r="1110010 1100110 1101100 1000010 1011100 1001110 1010000 1000100 1001000 1110100".split(" "),i=this[0],l=i.width;if(n.print_number)var e=0.95*i.height,k=0.9*e;else e=i.height,k=0.95*e;for(var b=l/95,f="",s="xxxxxx xxyxyy xxyyxy xxyyyx xyxxyy xyyxxy xyyyxx xyxyxy xyxyyx xyyxyx".split(" ")[parseInt(h.substr(0,
1))].split(""),h=h.substr(1),m=h.split(""),c=0;6>c;c++)f="x"==s[c]?f+a[m[c]]:f+q[m[c]];for(c=6;12>c;c++)f+=r[m[c]];if(i.getContext){var d=i.getContext("2d");d.fillStyle="rgb(0, 0, 0)";a=0;f=f.split("");d.fillRect(a,0,b,e);a+=2*b;d.fillRect(a,0,b,e);a+=b;for(c=0;42>c;c++)"1"==f[c]&&d.fillRect(a,0,b,k),a+=b;a+=b;d.fillRect(a,0,b,e);a+=2*b;d.fillRect(a,0,b,e);a+=2*b;for(c=42;84>c;c++)"1"==f[c]&&d.fillRect(a,0,b,k),a+=b;d.fillRect(a,0,b,e);d.fillRect(a+2*b,0,b,e);if(n.print_number){d.font=0.2*k+"px monospace";
var g=3*b;j.each(h.substr(0,6).split(""),function(a,b){d.fillText(b,g,1.03*e);g+=0.08*l});g=49*b;j.each(h.substr(6).split(""),function(a,b){d.fillText(b,g,1.03*e);g+=0.08*l})}}else alert("jQuery.EAN13: error!")}})(jQuery);